create database KoolZaitsev
use KoolZaitsev;

create table opilane (
	opilaneID INT primary key,
	eesnimi VARCHAR(50),
	perenimi VARCHAR(50),
	epost VARCHAR(50),
	sugu VARCHAR(50),
	stip DECIMAL(5,2)
);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (1, 'Kacy', 'Woolfall', 'kwoolfall0@slashdot.org', 'Female', 77.47);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (2, 'Vanya', 'Kordas', 'vkordas1@hao123.com', 'Female', 55.48);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (3, 'Mavra', 'Winscum', 'mwinscum2@wired.com', 'Polygender', 20.21);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (4, 'Jamal', 'Macconaghy', 'jmacconaghy3@technorati.com', 'Male', 34.26);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (5, 'Reed', 'Wisham', 'rwisham4@google.pl', 'Male', 65.88);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (6, 'Karissa', 'Bilham', 'kbilham5@cnbc.com', 'Non-binary', 91.52);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (7, 'Vinson', 'Garlick', 'vgarlick6@java.com', 'Male', 23.54);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (8, 'Chrisse', 'Quadrio', 'cquadrio7@blog.com', 'Male', 90.78);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (9, 'Dale', 'Faithfull', 'dfaithfull8@t-online.de', 'Male', 69.07);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (10, 'Farlie', 'Chaffen', 'fchaffen9@accuweather.com', 'Male', 98.39);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (11, 'Giovanni', 'Manicom', 'gmanicoma@51.la', 'Male', 97.65);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (12, 'Dorey', 'Malia', 'dmaliab@apple.com', 'Female', 90.83);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (13, 'Scottie', 'Bamb', 'sbambc@addtoany.com', 'Male', 89.67);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (14, 'Helen', 'Dory', 'hdoryd@blog.com', 'Female', 97.01);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (15, 'Darn', 'Nuccii', 'dnucciie@java.com', 'Male', 31.52);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (16, 'Jo-ann', 'Bracknell', 'jbracknellf@ucla.edu', 'Female', 62.13);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (17, 'Ulla', 'Boutwell', 'uboutwellg@yale.edu', 'Female', 43.22);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (18, 'Noll', 'Abriani', 'nabrianih@biblegateway.com', 'Male', 76.45);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (19, 'Bernardine', 'Dyble', 'bdyblei@gov.uk', 'Female', 86.28);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (20, 'Emeline', 'Linturn', 'elinturnj@wikimedia.org', 'Female', 29.58);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (21, 'Susy', 'Defraine', 'sdefrainek@baidu.com', 'Female', 46.69);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (22, 'Tandi', 'Bernhart', 'tbernhartl@hexun.com', 'Female', 90.51);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (23, 'Rivi', 'Smallsman', 'rsmallsmanm@princeton.edu', 'Female', 96.51);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (24, 'Wendeline', 'Bricklebank', 'wbricklebankn@gov.uk', 'Female', 44.54);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (25, 'Mathe', 'Rowantree', 'mrowantreeo@google.co.uk', 'Male', 61.65);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (26, 'Bordy', 'McCarrison', 'bmccarrisonp@thetimes.co.uk', 'Polygender', 62.49);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (27, 'Estella', 'Francesconi', 'efrancesconiq@ehow.com', 'Female', 64.6);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (28, 'Neils', 'Goldsworthy', 'ngoldsworthyr@msn.com', 'Male', 57.5);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (29, 'Cora', 'Pendrey', 'cpendreys@booking.com', 'Female', 4.09);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (30, 'Sasha', 'Duckerin', 'sduckerint@hao123.com', 'Male', 79.24);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (31, 'Brigit', 'McTavish', 'bmctavishu@biglobe.ne.jp', 'Genderqueer', 21.85);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (32, 'Keefer', 'Liddy', 'kliddyv@shareasale.com', 'Agender', 56.6);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (33, 'Hermie', 'Hullett', 'hhullettw@fda.gov', 'Male', 23.54);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (34, 'Betsey', 'Jambrozek', 'bjambrozekx@nih.gov', 'Female', 17.3);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (35, 'Dorry', 'Shickle', 'dshickley@apache.org', 'Female', 35.44);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (36, 'Amandy', 'Plant', 'aplantz@ox.ac.uk', 'Female', 47.99);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (37, 'Lemmy', 'Baldoni', 'lbaldoni10@jimdo.com', 'Male', 1.27);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (38, 'Morgan', 'Espinho', 'mespinho11@archive.org', 'Male', 73.27);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (39, 'Donny', 'Agass', 'dagass12@cnn.com', 'Male', 33.14);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (40, 'Elliot', 'Hargey', 'ehargey13@ed.gov', 'Male', 85.02);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (41, 'Sophia', 'Elland', 'selland14@ca.gov', 'Female', 97.55);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (42, 'Svend', 'Busch', 'sbusch15@tmall.com', 'Male', 85.79);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (43, 'Jackie', 'Paolotto', 'jpaolotto16@so-net.ne.jp', 'Female', 11.46);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (44, 'Letitia', 'Ovett', 'lovett17@liveinternet.ru', 'Female', 92.35);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (45, 'Christine', 'Abelovitz', 'cabelovitz18@ezinearticles.com', 'Female', 1.55);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (46, 'Kylie', 'Linsey', 'klinsey19@skyrock.com', 'Male', 57.54);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (47, 'Gleda', 'Hanne', 'ghanne1a@joomla.org', 'Female', 72.37);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (48, 'Mira', 'Cruse', 'mcruse1b@ezinearticles.com', 'Agender', 82.86);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (49, 'Benedetto', 'Ramelet', 'bramelet1c@sina.com.cn', 'Male', 81.31);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (50, 'Corby', 'Rolfs', 'crolfs1d@instagram.com', 'Male', 42.61);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (51, 'Keslie', 'Sibbe', 'ksibbe1e@posterous.com', 'Female', 62.94);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (52, 'Oby', 'Ottewill', 'oottewill1f@google.it', 'Male', 16.37);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (53, 'Sheilakathryn', 'Goalley', 'sgoalley1g@netscape.com', 'Female', 65.4);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (54, 'Tish', 'Kennedy', 'tkennedy1h@storify.com', 'Female', 96.88);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (55, 'Josie', 'Bernaldez', 'jbernaldez1i@wp.com', 'Female', 83.81);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (56, 'Xylia', 'Prater', 'xprater1j@tmall.com', 'Female', 51.34);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (57, 'Lucky', 'Bartlomiejczyk', 'lbartlomiejczyk1k@disqus.com', 'Female', 30.38);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (58, 'Leonora', 'Mattisssen', 'lmattisssen1l@slideshare.net', 'Female', 26.03);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (59, 'Patti', 'Girvan', 'pgirvan1m@naver.com', 'Female', 23.24);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (60, 'Dorthy', 'Kubacek', 'dkubacek1n@youku.com', 'Genderqueer', 13.21);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (61, 'Seline', 'Beadle', 'sbeadle1o@ycombinator.com', 'Female', 39.12);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (62, 'Meyer', 'Matterson', 'mmatterson1p@imdb.com', 'Agender', 54.37);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (63, 'Abigael', 'Huebner', 'ahuebner1q@t-online.de', 'Female', 42.89);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (64, 'Neely', 'Sacks', 'nsacks1r@indiegogo.com', 'Female', 90.93);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (65, 'Krissy', 'Caudwell', 'kcaudwell1s@dagondesign.com', 'Female', 67.52);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (66, 'Leroy', 'Pfeiffer', 'lpfeiffer1t@sourceforge.net', 'Male', 46.22);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (67, 'Gilburt', 'Barlass', 'gbarlass1u@salon.com', 'Male', 97.96);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (68, 'Hilario', 'Babb', 'hbabb1v@scribd.com', 'Male', 38.46);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (69, 'Taryn', 'Simmance', 'tsimmance1w@ameblo.jp', 'Female', 25.07);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (70, 'Holli', 'Dana', 'hdana1x@yellowbook.com', 'Female', 54.16);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (71, 'Anatollo', 'Huertas', 'ahuertas1y@histats.com', 'Genderqueer', 71.26);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (72, 'Lorita', 'Edge', 'ledge1z@flavors.me', 'Female', 92.79);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (73, 'Josie', 'Vedyashkin', 'jvedyashkin20@mediafire.com', 'Genderqueer', 43.67);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (74, 'Eliza', 'Kingscott', 'ekingscott21@ucla.edu', 'Female', 46.01);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (75, 'Rodolph', 'Whymark', 'rwhymark22@narod.ru', 'Male', 91.35);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (76, 'Verena', 'Stooders', 'vstooders23@xing.com', 'Female', 69.88);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (77, 'Yorker', 'McGraffin', 'ymcgraffin24@unblog.fr', 'Male', 17.1);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (78, 'Rolf', 'Mulqueeny', 'rmulqueeny25@ftc.gov', 'Male', 20.46);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (79, 'Jonathan', 'McGuff', 'jmcguff26@nhs.uk', 'Male', 31.8);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (80, 'Dionis', 'Gadsdon', 'dgadsdon27@livejournal.com', 'Female', 29.56);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (81, 'Aharon', 'Crankshaw', 'acrankshaw28@goo.gl', 'Male', 6.72);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (82, 'Janine', 'Boorman', 'jboorman29@japanpost.jp', 'Female', 26.06);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (83, 'Colette', 'Cruce', 'ccruce2a@skyrock.com', 'Female', 86.41);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (84, 'Upton', 'Castagneto', 'ucastagneto2b@linkedin.com', 'Male', 13.51);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (85, 'Brietta', 'Ovey', 'bovey2c@gmpg.org', 'Female', 3.64);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (86, 'Eustace', 'Prior', 'eprior2d@japanpost.jp', 'Male', 99.99);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (87, 'Lynn', 'Wesker', 'lwesker2e@mozilla.org', 'Female', 75.39);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (88, 'Gordie', 'Bugbird', 'gbugbird2f@ycombinator.com', 'Male', 38.61);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (89, 'Virge', 'Ahlin', 'vahlin2g@mediafire.com', 'Male', 48.88);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (90, 'Marketa', 'Livings', 'mlivings2h@census.gov', 'Female', 40.75);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (91, 'Lazar', 'Rutigliano', 'lrutigliano2i@unesco.org', 'Male', 60.2);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (92, 'Janeta', 'Harling', 'jharling2j@tiny.cc', 'Female', 28.62);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (93, 'Monro', 'Lomax', 'mlomax2k@mit.edu', 'Non-binary', 9.94);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (94, 'Lora', 'Keefe', 'lkeefe2l@oaic.gov.au', 'Female', 33.23);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (95, 'Arlyne', 'Godlip', 'agodlip2m@huffingtonpost.com', 'Female', 21.95);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (96, 'Dewey', 'Lafflin', 'dlafflin2n@nymag.com', 'Male', 63.46);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (97, 'Titus', 'Anersen', 'tanersen2o@ftc.gov', 'Male', 23.04);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (98, 'Danell', 'Ackerley', 'dackerley2p@microsoft.com', 'Female', 39.23);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (99, 'Anissa', 'O''Beirne', 'aobeirne2q@wiley.com', 'Genderfluid', 54.76);
insert into opilane (opilaneID, eesnimi, perenimi, epost, sugu, stip) values (100, 'Stacee', 'Poznanski', 'spoznanski2r@gizmodo.com', 'Male', 60.78);

select perenimi, stip from opilane;

--kuva kolm esimest veergu ja soorteeri andmed stip järgi
--kasvavas järjekorras - viksemast suurimani, a-->z
--kahanevas järjekorras - desc -suurimast -->väikseni, Z-->A
select opilaneID, eesnimi, perenimi, stip
from opilane
order by stip desc;

--kuva eesnimi, mis on sorteeritud kahanevas järjekorras
select eesnimi from opilane 
order by eesnimi desc

--võrdlused
-- näita eesnimed mis algavad A tähega
SELECT eesnimi 
from opilane
where eesnimi like 'A%'

-- näita eesnimed ja perenimed mis algavad A tähega
SELECT eesnimi, perenimi
from opilane
where eesnimi like 'A%' OR perenimi LIKE 'A%'
-- näita õpilased, kellel eesnimed ja perenimed algavad A tähega
SELECT eesnimi, perenimi
from opilane
where eesnimi like 'A%' AND perenimi LIKE 'A%'
--näita eesnimied, kellel esimene ja viimane täht on sama
select eesnimi 
from opilane
where left(eesnimi,1)=right(eesnimi, 1)

-- < - väiksem kui, > - suurem kui, = -võrdne
--näita õpilase, kelle stip on suurem kui 50 ja väiksen kui 70
select stip 
from opilane
where stip>50 and stip<70

--BETWEEN
select perenimi, stip
from opilane
where stip BETWEEN 50 and 70
order by perenimi
--päringus sorteerimine ORDER BY kirjutame viimasena

--Agregaatfunktsioonid -COUNT, SUM, AVG, MIN, MAX
--Leiaõpilaste arv

SELECT count (*) as 'opilane Arv'
from opilane;

--Leia keskmine stip 
Select avg(stip) as 'avg stip'
from opilane;

--näita 5 õpilast kõige suurema stipiga

select top 5 perenimi, stip
from opilane
order by stip desc

--xampp kasutame TOP asemel LIMIT
select top 5 perenimi, stip
from opilane
order by stip desc
LIMIT 5;

--kombineerime tingimused
--eesnimed sisaldavad 't' ja stip (60-70)
SELECT eesnimi, stip
from opilane
where stip>60 and stip<70  and eesnimi like'%A%'
